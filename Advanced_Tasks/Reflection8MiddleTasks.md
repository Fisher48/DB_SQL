Рефлексия на 8 задач средней сложности по Dwarf Fortress:   
1. Получить информацию о всех гномах, которые входят в какой-либо отряд, вместе с информацией об их отрядах.  
Выполнил верно, только лишь указал явно _`WHERE d.squad_id IS NOT NULL`_ что подчёркивает логику, но по сути _`JOIN`_ сам отсекает _`NULL`_, 
когда отбирает строки по совпадениям _`squad_id`_.  
Также я вывожу все поля таблицы dwarves, но в эталоне только имя и профессия, это тоже дело вывода.
     

2. Найти всех гномов с профессией "miner", которые не состоят ни в одном отряде.  
Выполнено верно. Вывод также определенных полей в эталоне, у меня все поля выводятся.


3. Получить все задачи с наивысшим приоритетом, которые находятся в статусе "pending".  
Выполнено верно. Вывод также определенных полей в эталоне, у меня все поля выводятся.


4. Для каждого гнома, который владеет хотя бы одним предметом, получить количество предметов, которыми он владеет.  
Выполнено верно. Для лучшей читаемости, было бы лучше использовать _`i.item_id`_, вместо (*).


5. Получить список всех отрядов и количество гномов в каждом отряде. Также включите в выдачу отряды без гномов.  
Выполнено верно. Только не вывожу поле `squad_id` отряда.


6. Получить список профессий с наибольшим количеством незавершённых задач ("pending" и "in_progress") у гномов этих профессий.  
Выполнено верно. В эталоне выводятся все профессии, отсортированные по убыванию количества задач. 
По условию нужны только профессии с наибольшим числом задач 
(их может быть несколько, если у них одинаковое максимальное значение).
Я использовал (CTE - Общее табличное выражение) для лучшей читаемости запроса.


7. Для каждого типа предметов узнать средний возраст гномов, владеющих этими предметами.  
Выполнено верно. Здесь я также лишь указал явно _`WHERE owner_id IS NOT NULL`_ что подчёркивает логику, 
но по сути _`JOIN`_ уже автоматически исключает записи, где _`owner_id IS NULL`_.   


8. Найти всех гномов старше среднего возраста (по всем гномам в базе), которые не владеют никакими предметами.  
Выполнено верно. Я сделал выборку гномов, которые не владеют никакими предметами, используя _`NOT EXISTS`_.
Считается что он работает быстрее чем _`NOT IN`_.