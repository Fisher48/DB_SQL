Задание 2* в целом выполнено верно, но с некоторыми недочетами.  

В начале хочу сказать, что не видя таблицу в реализации, сложно понять какие поля что означают и нужно ли их использовать в своем запросе. 
Если бы можно было видеть пример полей, которые используются в БД. (какие бывают категории или что значит **_is_input_** в материалах).
Поэтому иногда, ты не можешь знать наверняка, какой смысл заключает в себе конкретное поле и какие типы в нем используются к примеру (_**category**_ в таблице _**skills**_).

Первое, что хочу отметить это структуру эталонного решения и насколько оно глубоко оно анализирует все показатели указанные в условии задачи.  

Расчет общего количества рабочих дней в эталоне производится более точно, используя дату назначения гнома в мастерской, что точнее отразит период активности мастерской.  
У меня же это первая дата производства.  
Также соединения таблицы продукта в первом CTE, у меня идет не по полю продукту, а по мастерской, что может некорректно рассчитать общее кол-во произведенной продукции.
Материалы еще должны соединятся по условию, что они входят в продукцию (**_wm.is_input = TRUE_**)

Мой расчет среднего умения ремесленников, некорректен.
В эталоне идет расчет среднего уровня навыков каждого гнома и максимальный уровень его навыка, также выбирается по типу _**'Crafting'**_ 
(у меня была мысль, что здесь нужно выбирать категорию).

В эталоне есть отдельный CTE **_craftsdwarf_productivity_** для анализа продуктивности каждого ремесленника, в котором считается сколько продуктов произвел каждый ремесленник, 
усредненное качество и общая созданная стоимость.

В эталоне рассчитывается отдельно CTE **_material_efficiency_**, в котором идет анализ материалов по мастерским, 
считаются все входящие в продукт материалы и отдельно выходящие. Также идет подсчет уникальных материалов, четкое разделение на входные и выходные.
Как раз на основе этого CTE, затем в основном запрос происходит правильный подсчет эффективности по материалам **_material_conversion_ratio_**,
в котором более эффективно учитываются выходные и входные материалы и их отношение.

Касаемо расчета Влияния навыка ремесленников на качество продукции, у меня считается средний навык и среднее качество, но нет анализа связи между ними.
В эталоне идет более точная корреляция, т.к. идет расчет по каждому гному и учитывается средний и максимальный уровень, а не агрегация по мастерским и только средний уровень.

И финальная сортировка в эталоне выполнена более эффективно, учитывает все показатели, как настоящее KPI.  
Умножая два показателя, получается общая оценка эффективности мастерской.
Показатель прибыльности мастерской (Сколько ценности произведено на единицу затраченных материалов) * 
Показатель эффективности использования времени мастерской (какую часть времени мастерская реально работала).  
В моем случае я сортирую только по общей ценности произведенной продукции, что не совсем достаточно для полного анализа.

