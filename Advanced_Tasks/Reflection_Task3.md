Задание 3* выполнено не совсем верно, но в целом хорошо.   
Основные параметры оценивающие эффективность в большинстве указаны верно.

Хочу опять же отметить полноту эталонного решения. И как глубоко реализована логика запросов и анализ.

В эталоне присутствуют поля, которые в примере и условиях задачи не были указаны как необходимые к выборке и отображению, 
не считаю это недочетом, лишь скажу что это улучшает запрос и делает его более детализированным.

Опять, как и в предыдущей задаче, ввиду не знания примеров некоторых полей, я не смог полностью сделать условие для выборки категории умений,
догадался только про **_'Combat'_**, про **_'Military'_** не смог.

В CTE **_squad_member_history_**, кол-во текущих бойцов в отряде выбирается по признаку **_WHEN sm.exit_reason IS NULL_**, у меня же **_WHEN sm.exit_date IS NULL_**, 
я пошел по схожей логике, думаю здесь не должно быть недочетов, ведь если нет даты выхода, то боец не покидал отряд, то же самое если нет причины выхода из отряда.

Мой подсчет навыков и их улучшений после сражений неверен, было лишним добавлять **_ELSE 0_**, т.к это обнулит весь подсчет.
Я считал все уровни до вступления и после вступления в отряд, в эталоне берется уровень навыка точно в момент вступления и точно на текущий момент.
В эталоне более точный подход и показывает реальный прогресс за время службы в отряде. 

В CTE **_squad_equipment_quality_** анализ качества экипировок более детален и учитывает 3 типа экипировки **_e.type = 'Weapon', 'Armor' и 'Shield'_**.  
Еще раз повторюсь, ввиду не знания примеров некоторых полей, не всегда удается понять что требуется учитывать.


В CTE **_squad_training_effectiveness_** учитывает корреляцию эффективности тренировок на исход текущего боя.  
Мой анализ корреляции между общим кол-вом тренировок к кол-ву побед. В моем случае я пытаюсь посчитать, чем больше тренировок тем больше побед (это вполне логично).
Но если углубится и понять эталонное решение, то оно верно показывает связь эффективности тренировок по отношению к победам. 
Ведь если тренировки были очень эффективными, то их может быть и малое кол-во и они могут давать больше побед. Нежели много некачественных тренировок.

В заключении основной запрос.
Я сделал ошибку и в некоторых полях не учел процент, необходимо было **_умножить на 100_**  в **_victory_percentage, casualty_rate, retention_rate_**.
В эталоне присутствуют поля, которые не указны примерах или условии, но это дополняет основной запрос расширяя его и делая его более гибким для дальнейшего анализа.
Общий показатель эффективности в эталоне рассчитан более корректно и также учитывает соотношение потерь **_casualty_rate_**, _(1 - ...)_ инвертирует значение, 
чтобы показать выживаемость, то есть чем меньше потерь, тем выше оценка.  
И качество экипировки **_avg_equipment_quality_** также учитывается. Веса распределены более гармонично. 
Могу предположить здесь, что при делении на 5, есть шкала в которой 5 это макс значение, для нормализации значения в диапазоне.
То же самое касается **_avg_skill_improvement_**.

И в JSON объектах связанных сущностях, я упустил момент где требовалось указать идентификаторы членов отряда, нужно было указать доп. условие **_sm.exit_date IS NULL_** -
указывающее на текущих членов отряда, а у меня все члены.

Также у меня группировка идет только по базовым полям, в эталоне по всем агрегирующим поля идет группировка и не только.   
Мне тоже стоило делать так, тем более, что в основном запросе тоже присутствуют агрегирующие функции.


