Задание **1** под * выполнено почти верно.  
В эталоне сделано все намного лучше, кол-во обращений к БД меньше и запрос,
который определит наиболее и наименее успешные экспедиции выполнится намного быстрее.
Очень структурировано все сделано особенно первое CTE, в котором аккумулируются данные как статистка по экспедициям.  

В первом CTE (_**expedition_stats**_) сразу считаются необходимые поля, которые потом используются в основном запросе, за счет чего минимизируются повторные джоины.  
Также, во втором CTE (_**skills_progression**_) сразу определяется разница уровней до экспедиции и после, фильтруя данные по дате, 
и это будет точнее чем в моем случае, когда я ориентируюсь на поле _**em.return_date IS NULL**_ и _**NOT NULL**_.

В полях, где анализируется отношение, стоило использовать _**NULLIF**_, для проверки значения на _**NULL**_ и избегания ошибок.  
При делении / всегда стоит использовать _**NULLIF**_.

По поводу вычисления продолжительности экспедиции **_expedition_duration_**, в случае с эталоном используется функция **_EXTRACT (DAY FROM)_**,
оно вернет тип INTEGER, т.е целое число дней, в моем случае, если _PostgreSQL_, то вернется INTERVAL, но все зависит от типа БД.   
Выбор зависит от типа данных в столбцах, но лучше для стандартизации и совместимости с другими СУБД, стоит использовать EXTRACT как в эталоне.

В основном запросе именно при расчете _**overall_success_score**_ используется более взвешенный анализ, 
здесь конечно вес зависит от логики, и того как стоило рассчитывать общий коэффициент успеха, 
как я понял из эталона 100% - это все показатели и между ними распределены проценты (_30-25-15-15-15_).
Разный показатель по-разному влияет на успех.
